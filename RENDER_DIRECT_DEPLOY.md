# دليل النشر المباشر على Render.com

هذا الدليل المفصل يشرح كيفية نشر تطبيق ButterBakery مباشرة على منصة Render.com باستخدام ملف الضغط الجاهز دون الحاجة للتكامل مع GitHub.

## المتطلبات

1. حساب على [Render.com](https://render.com) (يمكنك التسجيل مجانًا)
2. ملف `butterbakery-render-deployment-v2.zip` (حجمه حوالي 6.9 ميجابايت)
3. متصفح حديث وإنترنت مستقر

## الجزء 1: إنشاء قاعدة بيانات PostgreSQL

### خطوات إنشاء قاعدة البيانات

1. سجل الدخول إلى حسابك على Render.com
2. من لوحة التحكم الرئيسية، انقر على زر "New +" في الزاوية العلوية اليمنى
3. اختر "PostgreSQL" من القائمة

4. أدخل المعلومات التالية:
   - **Name**: `butterbakery-db` (أو أي اسم تفضله)
   - **Database**: `butterbakery`
   - **User**: `butterbakery_user` (أو أي اسم مستخدم تفضله)
   - **Region**: اختر المنطقة الأقرب لموقعك الجغرافي
   - **PostgreSQL Version**: اختر الإصدار الافتراضي
   - **Instance Type**: يمكنك البدء بالخطة المجانية وترقيتها لاحقًا إذا لزم الأمر

5. انقر على زر "Create Database"

6. سيستغرق الأمر بضع دقائق لإنشاء قاعدة البيانات. انتظر حتى تظهر حالة "Available" (متوفرة)

### الحصول على معلومات الاتصال بقاعدة البيانات

1. بعد إنشاء قاعدة البيانات، انقر عليها في لوحة التحكم
2. ستجد قسمًا يسمى "Connections" يحتوي على:
   - **Internal Database URL**: هذا هو عنوان الاتصال الداخلي الذي سنستخدمه لربط التطبيق بقاعدة البيانات
   - **External Database URL**: لا تحتاج إليه في هذه العملية
   - **PSQL Command**: أمر للاتصال بقاعدة البيانات من سطر الأوامر (للاستخدام المتقدم)

3. انسخ **Internal Database URL** واحتفظ به - ستحتاج إليه في الخطوات التالية

## الجزء 2: إنشاء خدمة الويب

### خطوات إنشاء خدمة الويب

1. من لوحة التحكم الرئيسية، انقر على زر "New +" مرة أخرى
2. اختر "Web Service" من القائمة

3. في صفحة "Create a new Web Service"، ستجد عدة خيارات للنشر. اختر "Deploy from a zip file"

4. انقر على "Choose File" لاختيار ملف `butterbakery-render-deployment-v2.zip` من جهازك
   - تأكد من استخدام أحدث نسخة من الملف
   - قد يستغرق الرفع بعض الوقت حسب سرعة الإنترنت لديك

5. بمجرد اكتمال الرفع، أدخل المعلومات التالية:
   - **Name**: `butterbakery-app` (أو أي اسم تفضله)
   - **Environment**: `Node`
   - **Region**: اختر نفس المنطقة التي اخترتها لقاعدة البيانات للحصول على أفضل أداء
   - **Branch**: يمكن تركه فارغًا
   - **Build Command**: `npm install`
   - **Start Command**: `node start.js`
   - **Instance Type**: يمكنك البدء بالخطة المجانية وترقيتها لاحقًا إذا لزم الأمر

### إعداد متغيرات البيئة

1. انتقل إلى قسم "Environment" في نفس الصفحة
2. أضف المتغيرات البيئية التالية:

   | المفتاح (Key) | القيمة (Value) | الوصف |
   |---------------|----------------|--------|
   | `DATABASE_URL` | الصق عنوان الاتصال الداخلي الذي نسخته من قاعدة البيانات | عنوان الاتصال بقاعدة البيانات |
   | `NODE_ENV` | `production` | وضع تشغيل التطبيق |
   | `PORT` | `10000` | المنفذ الذي سيعمل عليه التطبيق |

3. تأكد من صحة عنوان الاتصال بقاعدة البيانات
   - يجب أن يبدأ بـ `postgres://`
   - يجب أن يحتوي على معلومات المستخدم وكلمة المرور واسم قاعدة البيانات

### إعدادات متقدمة (اختيارية)

يمكنك ضبط إعدادات إضافية وفقًا لاحتياجات التطبيق الخاص بك:

1. **Auto-Deploy**: يمكنك إبقاءه معطلاً لأننا نستخدم ملف الضغط مباشرة
2. **Preview Environment**: للبيئات الإنتاجية، يمكنك إيقاف تشغيل بيئات المعاينة
3. **Health Check Path**: يمكنك تعيينه إلى `/health` للتحقق من حالة التطبيق

4. انقر على زر "Create Web Service" لبدء عملية النشر

## الجزء 3: مراقبة عملية النشر

### متابعة التقدم

1. بعد إنشاء خدمة الويب، ستتم إعادة توجيهك إلى صفحة التطبيق
2. يمكنك متابعة تقدم النشر في قسم "Events" أو "Logs"
3. ستمر عملية النشر بعدة مراحل:
   - تحميل الملفات
   - تثبيت التبعيات (`npm install`)
   - بناء التطبيق
   - بدء تشغيل التطبيق

4. قد تستغرق العملية بأكملها 5-10 دقائق على حسب موارد الخادم والخطة المختارة

### التحقق من نجاح النشر

1. بمجرد اكتمال النشر، ستظهر حالة "Live" (نشط) بجانب اسم التطبيق
2. ستجد عنوان URL للتطبيق في الأعلى (عادة ما يكون بتنسيق `https://butterbakery-app.onrender.com`)
3. انقر على هذا العنوان للوصول إلى التطبيق

## الجزء 4: الوصول إلى التطبيق وبدء الاستخدام

### تسجيل الدخول الأول

1. عند فتح التطبيق للمرة الأولى، قد يستغرق التحميل بضع ثوانٍ إضافية
2. ستظهر صفحة تسجيل الدخول
3. استخدم بيانات تسجيل الدخول الافتراضية:
   - **اسم المستخدم**: `admin`
   - **كلمة المرور**: `admin`

4. بعد تسجيل الدخول بنجاح، ستتم إعادة توجيهك إلى لوحة التحكم الرئيسية

### تغيير كلمة المرور الافتراضية

من المهم تغيير كلمة المرور الافتراضية فورًا لأسباب أمنية:

1. انقر على اسم المستخدم أو أيقونة الملف الشخصي في الأعلى
2. اختر "إعدادات الحساب" أو "الملف الشخصي"
3. انقر على "تغيير كلمة المرور"
4. أدخل كلمة المرور القديمة (`admin`) وكلمة المرور الجديدة
5. انقر على "حفظ" أو "تأكيد"

### الإعداد الأولي للتطبيق

بعد تسجيل الدخول بنجاح، يمكنك البدء في إعداد التطبيق:

1. **إعداد الفروع**: قم بإضافة فروع المخبز
2. **إضافة المستخدمين**: قم بإنشاء حسابات للموظفين والمدراء
3. **إعداد الأهداف الشهرية**: حدد أهداف المبيعات لكل فرع
4. **بدء إدخال البيانات**: ابدأ في تسجيل المبيعات اليومية والمعاملات

## استكشاف الأخطاء وإصلاحها

إذا واجهت أي مشكلات أثناء عملية النشر أو بعدها:

### مشكلات النشر الشائعة

1. **خطأ في الاتصال بقاعدة البيانات**:
   - تأكد من صحة عنوان الاتصال في متغيرات البيئة
   - تحقق من حالة قاعدة البيانات (يجب أن تكون "Available")
   - تأكد من استخدام عنوان الاتصال **الداخلي** وليس الخارجي

2. **فشل البناء أو التشغيل**:
   - راجع سجلات التطبيق في لوحة تحكم Render.com
   - تأكد من صحة أوامر البناء والتشغيل
   - تحقق من أن ملف الضغط يحتوي على جميع الملفات الضرورية

### الحصول على المساعدة

للمزيد من المساعدة، يمكنك الرجوع إلى:

- [دليل استكشاف الأخطاء وإصلاحها](./TROUBLESHOOTING.md)
- [وثائق Render.com الرسمية](https://render.com/docs)

## الإدارة المستمرة

### المراقبة والأداء

- يمكنك مراقبة أداء التطبيق وموارد الخادم من خلال لوحة تحكم Render.com
- راجع سجلات التطبيق بانتظام للتعرف على أي مشكلات محتملة
- إذا لاحظت بطءًا في الأداء، فكر في ترقية خطة الخدمة

### النسخ الاحتياطي

Render.com يقوم تلقائيًا بعمل نسخ احتياطية لقاعدة البيانات كل 24 ساعة. ومع ذلك، يمكنك أيضًا:

1. عمل نسخ احتياطية يدوية قبل إجراء تغييرات كبيرة
2. تنزيل النسخ الاحتياطية للاحتفاظ بها محليًا
3. جدولة نسخ احتياطية إضافية باستخدام الإعدادات المتقدمة

### التحديثات المستقبلية

عندما تحتاج إلى تحديث التطبيق مستقبلاً:

1. احصل على أحدث نسخة من ملف الضغط
2. اتبع نفس عملية النشر، ولكن بدلاً من إنشاء خدمة جديدة:
   - انتقل إلى خدمة الويب الحالية
   - اذهب إلى علامة التبويب "Settings"
   - انتقل إلى قسم "Deploy from a zip file"
   - قم بتحميل ملف الضغط الجديد
   - انقر على "Save Changes"

للمزيد من التفاصيل حول التحديثات، راجع [دليل الترقية](./UPGRADE_GUIDE.md).

---

**ملاحظة**: يمكنك بدء استخدام التطبيق مع الخطة المجانية، ولكن للاستخدام الإنتاجي الواقعي، نوصي بالترقية إلى خطة مدفوعة للحصول على موارد أكثر وأداء أفضل.